/**
 * 基本拍品相关
 */


/**
 * 当前时间是否在 timestart 到 timeend 之间
 * @param  {Date} now          当前时间对象
 * @param  {String} timestart  开始时间字符串
 * @param  {String} timeend    结束时间字符串
 * @return {Boolean}           是否在区间内
 */
exports.inTimeRange = function(now, timestart, timeend) {
  var timestartArr = timestart && timestart.split(':'),
    timesendArr = timeend && timeend.split(':'),
    currentHour = now.getHours(),
    currentMinute = now.getMinutes();
  return timestartArr && timesendArr &&
    timestartArr.length == 2 &&
    timesendArr.length == 2 &&
    (currentHour > timestartArr[0] || (currentHour == timestartArr[1] && currentMinute >= timestartArr[1])) &&
    (currentHour < timestartArr[0] || (currentHour == timestartArr[1] && currentMinute <= timestartArr[1]));
};

/**
 * 修复时间戳到毫秒(标准的应该是秒)
 * @param  {Long} time 时间戳
 * @return {Long}      修复后的时间戳
 */
exports.reCorrectTime = function(time) {
  time = parseInt(time);
  var now = +new Date();
  if (now - time > 1000 * 60 * 60 * 24 * 365) {
    return time * 1000;
  }
  return time;
};

/**
 * 格式化公里数
 * @param  {String} miles 公里字符串
 * @return {String}       格式化后的字符串
 */
exports.formatMils = function(miles) {
  if (!miles) {
    return '';
  }
  if (miles.indexOf('公里') != -1) {
    return miles;
  }
  if (miles.length >= 4) {
    return (new Number(miles / 10000)).toFixed(1) + '万公里';
  }
  if (miles) {
    return miles + '公里';
  }
};

/**
 * 格式化上牌时间
 * @param  {String} date 日期字符串
 * @return {String}      格式化后的字符串
 */
exports.formatLicenseDate = function(date) {
  if (date) {
    var match = date.match(/(\d+)[-.年](\d+)月?/);
    if (match && match.length == 3) {
      return match[1] + '.' + this.pad(match[2]) + '上牌';
    }
  }
  return '';
};

/**
 * pad
 * @param  {number} num 数字
 * @return {number}     pad后的字符串
 */
exports.pad = function(num) {
  if (num && num.length == 1) {
    return '0' + num;
  }
  return num;
};